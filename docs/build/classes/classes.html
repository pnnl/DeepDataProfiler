<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>classes package &mdash; Deep Data Profiler 1.2.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="algorithms" href="../algorithms/modules.html" />
    <link rel="prev" title="classes" href="modules.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Deep Data Profiler
            <img src="../_static/Profilingicon.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Profiling</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">classes package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-classes.channel_profiler">classes.channel_profiler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-classes.element_profiler">classes.element_profiler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-classes.profile">classes.profile module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-classes.spatial_profiler">classes.spatial_profiler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-classes.svd_influential">classes.svd_influential module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-classes.torch_profiler">classes.torch_profiler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-classes">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/modules.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing Deep Data Profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tableofcontents.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Deep Data Profiler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">classes</a> &raquo;</li>
      <li>classes package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/classes/classes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="classes-package">
<h1>classes package<a class="headerlink" href="#classes-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-classes.channel_profiler">
<span id="classes-channel-profiler-module"></span><h2>classes.channel_profiler module<a class="headerlink" href="#module-classes.channel_profiler" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classes.channel_profiler.</span></span><span class="sig-name descname"><span class="pre">ChannelProfiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">deep_data_profiler.classes.torch_profiler.TorchProfiler</span></code></p>
<p>ChannelProfiler identifies influential channels of an activation tensor. Influential
channel neurons are identified by either maximum value or matrix norm. Contributing
neurons in the previous layer are the channels with the greatest maximum values
whose sum reaches a specified threshold, or percentage of the maximum value in the
influential channel.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.contrib_adaptive_avg_pool2d">
<span class="sig-name descname"><span class="pre">contrib_adaptive_avg_pool2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.contrib_adaptive_avg_pool2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.contrib_adaptive_avg_pool2d" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a 2D
adaptive average pooling layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.contrib_conv2d">
<span class="sig-name descname"><span class="pre">contrib_conv2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.contrib_conv2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.contrib_conv2d" title="Permalink to this definition"></a></dt>
<dd><p>Profile a single output neuron from a 2D convolutional layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing keys in self.model.available_modules() dictionary,
corresponding to a convolutional module and an activation module</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>neuron_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only implemented for convolution using filters with same height and width
and strides equal in both dimensions and padding equal in all dimensions</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.contrib_identity">
<span class="sig-name descname"><span class="pre">contrib_identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.contrib_identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.contrib_identity" title="Permalink to this definition"></a></dt>
<dd><p>Pass through to keep influential neurons from one layer fixed into the
next.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>neuron_counts</em></p></li>
<li><p><em>synapse_counts</em></p></li>
<li><p><em>synapse_weights</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.contrib_linear">
<span class="sig-name descname"><span class="pre">contrib_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.contrib_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.contrib_linear" title="Permalink to this definition"></a></dt>
<dd><p>Profile output neurons from a linear layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing single key in self.model.available_modules() dictionary</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.contrib_max2d">
<span class="sig-name descname"><span class="pre">contrib_max2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.contrib_max2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.contrib_max2d" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a 2D
max pooling layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.contrib_resnetadd">
<span class="sig-name descname"><span class="pre">contrib_resnetadd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.contrib_resnetadd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.contrib_resnetadd" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a ResNet add
layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>neuron_counts</em></p></li>
<li><p><em>synapse_counts</em></p></li>
<li><p><em>synapse_weights</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raises error if len(x_in) != 2 or len(y_out) != 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.create_profile">
<span class="sig-name descname"><span class="pre">create_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deep_data_profiler.classes.profile.Profile</span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.create_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.create_profile" title="Permalink to this definition"></a></dt>
<dd><p>Generate a profile for a single input data x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – input to model being profiled</p></li>
<li><p><strong>layers_to_profile</strong> (<em>list</em><em> or </em><em>tuple</em>) – list of specific layers to profile or tuple with first,last layers
(exclusive of last) to profile and all layers inbetween</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Percentage of contribution to track in a profile.</p></li>
<li><p><strong>norm</strong> (<em>int</em><em>, </em><em>optional</em>) – If given, the order of the norm to be taken to sum the strengths of channel
activations. Otherwise, the max value of each channel is used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>profile contains neuron_counts, neuron_weights, synapse_counts, and synapse_weights
across layers in layers_to_profile. Corresponding number of images = 1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#classes.profile.Profile" title="classes.profile.Profile">Profile</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.influence_generator">
<span class="sig-name descname"><span class="pre">influence_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.influence_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.influence_generator" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activations</strong> (<em>dict of tensors</em>) – </p></li>
<li><p><strong>norm</strong> (<em>int</em><em>, </em><em>optional</em>) – If given, the order of the norm to be taken to sum the strengths of channel
activations. Otherwise, the max value of each channel is used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>influential_neurons</strong> – A function that will pick out the most influential neurons
in a layer up to some threshold</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.channel_profiler.ChannelProfiler.single_profile">
<span class="sig-name descname"><span class="pre">single_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">scipy.sparse.coo.coo_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/channel_profiler.html#ChannelProfiler.single_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.channel_profiler.ChannelProfiler.single_profile" title="Permalink to this definition"></a></dt>
<dd><p>Profiles a single layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>) – Matrix representing the influential neurons in the layer</p></li>
<li><p><strong>ldx</strong> (<em>int</em>) – Layer number of the layer to be profiled</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Percentage of contribution to track in a profile</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix or tuple of sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-classes.element_profiler">
<span id="classes-element-profiler-module"></span><h2>classes.element_profiler module<a class="headerlink" href="#module-classes.element_profiler" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classes.element_profiler.</span></span><span class="sig-name descname"><span class="pre">ElementProfiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">deep_data_profiler.classes.torch_profiler.TorchProfiler</span></code></p>
<p>ElementProfiler identifies influential elements of an activation tensor. Influential
element neurons are identified by their value or absolute value. Contributing
neurons in the previous layer are the elements in the receptive field with the
greatest values whose sum reaches a specified threshold, or percentage of the
value of the influential element.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.contrib_adaptive_avg_pool2d">
<span class="sig-name descname"><span class="pre">contrib_adaptive_avg_pool2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.contrib_adaptive_avg_pool2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.contrib_adaptive_avg_pool2d" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a 2D
adaptive average pooling layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential x 3 (channel, row, col)</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing single key in self.model.available_modules() dictionary</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.contrib_conv2d">
<span class="sig-name descname"><span class="pre">contrib_conv2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.contrib_conv2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.contrib_conv2d" title="Permalink to this definition"></a></dt>
<dd><p>Profile a single output neuron from a 2D convolutional layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential x 3 (channel, row, col)</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing keys in self.model.available_modules() dictionary,
corresponding to a convolutional module and an activation module</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>neuron_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only implemented for convolution using filters with same height and width
and strides equal in both dimensions and padding equal in all dimensions</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.contrib_identity">
<span class="sig-name descname"><span class="pre">contrib_identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.contrib_identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.contrib_identity" title="Permalink to this definition"></a></dt>
<dd><p>Pass through to keep influential neurons from one layer fixed into the
next. Used for normalization layers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential x 3 (channel, row, col)</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>neuron_counts</em></p></li>
<li><p><em>synapse_counts</em></p></li>
<li><p><em>synapse_weights</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.contrib_linear">
<span class="sig-name descname"><span class="pre">contrib_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.contrib_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.contrib_linear" title="Permalink to this definition"></a></dt>
<dd><p>Profile output neurons from a linear layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing single key in self.model.available_modules() dictionary</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.contrib_max2d">
<span class="sig-name descname"><span class="pre">contrib_max2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.contrib_max2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.contrib_max2d" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a 2D
max pooling layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential x 3 (channel, row, col)</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing single key in self.model.available_modules() dictionary</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.contrib_resnetadd">
<span class="sig-name descname"><span class="pre">contrib_resnetadd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.contrib_resnetadd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.contrib_resnetadd" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a ResNet add
layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential x 3 (channel, row, col)</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>neuron_counts</em></p></li>
<li><p><em>synapse_counts</em></p></li>
<li><p><em>synapse_weights</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raises error if len(x_in) != 2 or len(y_out) != 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.create_profile">
<span class="sig-name descname"><span class="pre">create_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deep_data_profiler.classes.profile.Profile</span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.create_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.create_profile" title="Permalink to this definition"></a></dt>
<dd><p>Generate a profile for a single input data x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – input to model being profiled</p></li>
<li><p><strong>layers_to_profile</strong> (<em>list</em><em> or </em><em>tuple</em>) – list of specific layers to profile or tuple with first,last layers
(exclusive of last) to profile and all layers inbetween</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Percentage of contribution to track in a profile.</p></li>
<li><p><strong>use_abs</strong> (<em>boolean</em><em>, </em><em>default=False</em>) – If True, use the absolute value of element activations to determine influence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>profile contains neuron_counts, neuron_weights, synapse_counts, and synapse_weights
across layers in layers_to_profile. Corresponding number of images = 1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#classes.profile.Profile" title="classes.profile.Profile">Profile</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.influence_generator">
<span class="sig-name descname"><span class="pre">influence_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.influence_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.influence_generator" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activations</strong> (<em>dict of tensors</em>) – </p></li>
<li><p><strong>use_abs</strong> (<em>boolean</em><em>, </em><em>default=False</em>) – If True, use the absolute value of element activations to determine influence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>influential_neurons</strong> – A function that will pick out the most influential neurons
in a layer up to some threshold</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.element_profiler.ElementProfiler.single_profile">
<span class="sig-name descname"><span class="pre">single_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">scipy.sparse.coo.coo_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/element_profiler.html#ElementProfiler.single_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.element_profiler.ElementProfiler.single_profile" title="Permalink to this definition"></a></dt>
<dd><p>Profiles a single layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>) – Matrix representing the influential neurons in the layer</p></li>
<li><p><strong>ldx</strong> (<em>int</em>) – Layer number of the layer to be profiled</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Percentage of contribution to track in a profile</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix or tuple of sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-classes.profile">
<span id="classes-profile-module"></span><h2>classes.profile module<a class="headerlink" href="#module-classes.profile" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="classes.profile.Profile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classes.profile.</span></span><span class="sig-name descname"><span class="pre">Profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synapse_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synapse_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/profile.html#Profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.profile.Profile" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Summary</p>
<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.activation_shapes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">activation_shapes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Size</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#classes.profile.Profile.activation_shapes" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>activation_shapes</strong> – Dictionary of the activation tensors shapes, keyed by layer
:rtype: Dict of torch.Sizes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.profile.Profile.dict_view">
<span class="sig-name descname"><span class="pre">dict_view</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#classes.profile.Profile" title="classes.profile.Profile"><span class="pre">classes.profile.Profile</span></a></span></span><a class="reference internal" href="../_modules/classes/profile.html#Profile.dict_view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.profile.Profile.dict_view" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>A copy of the profile with neuron and synapse counts and weights</em></p></li>
<li><p><em>reformatted as dicts</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.neuron_counts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">neuron_counts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#classes.profile.Profile.neuron_counts" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>neuron_counts</strong> – Dictionary representing profile neurons and their counts, i.e. how many             synapses they were influential or contributing to
:rtype: Dict of scipy.sparse matrices or Dict of dicts</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.neuron_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">neuron_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#classes.profile.Profile.neuron_type" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>neuron_type</strong> – The type of neurons used in the profile, i.e. ‘element’, ‘channel’, or             ‘mixed’ (aggregate of profiles with mismatched types)
:rtype: str</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.neuron_weights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">neuron_weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#classes.profile.Profile.neuron_weights" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>neuron_weights</strong> – Dictionary representing influential profile neurons and their weights
:rtype: Dict of scipy.sparse matrices or Dict of dicts</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.num_inputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_inputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#classes.profile.Profile.num_inputs" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>num_inputs</strong> – The number of input images represented by the profile
:rtype: int</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Class profiles and other aggregate profiles will have num_inputs &gt; 1</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.num_synapses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_synapses</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#classes.profile.Profile.num_synapses" title="Permalink to this definition"></a></dt>
<dd><p>returns: Total number of synapses across all layers
:rtype: int</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.pred_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pred_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#classes.profile.Profile.pred_dict" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>pred_dict</strong> – Dictionary giving the layer predecessor hierarchy by layer index
:rtype: Dict of list of ints</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#classes.profile.Profile.size" title="Permalink to this definition"></a></dt>
<dd><p>returns: Total number of neurons identified as influential or contributing             (neurons with nonzero neuron counts)
:rtype: int</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.synapse_counts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">synapse_counts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#classes.profile.Profile.synapse_counts" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>synapse_counts</strong> – Dictionary representing profile synapses and their counts
:rtype: Dict of scipy.sparse matrices or Dict of dicts</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a single image profile (num_inputs=1) all synapses should have a count of 1</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.synapse_weights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">synapse_weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.base.spmatrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#classes.profile.Profile.synapse_weights" title="Permalink to this definition"></a></dt>
<dd><p>returns: <strong>synapse_weights</strong> – Dictionary representing profile synapses and their weights
:rtype: Dict of scipy.sparse matrices or Dict of dicts</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="classes.profile.Profile.total">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#classes.profile.Profile.total" title="Permalink to this definition"></a></dt>
<dd><p>returns: Total sum of neuron counts across all layers
:rtype: int</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-classes.spatial_profiler">
<span id="classes-spatial-profiler-module"></span><h2>classes.spatial_profiler module<a class="headerlink" href="#module-classes.spatial_profiler" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classes.spatial_profiler.</span></span><span class="sig-name descname"><span class="pre">SpatialProfiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">deep_data_profiler.classes.torch_profiler.TorchProfiler</span></code></p>
<p>SpatialProfiler identifies influential “spatial neurons”, or tube-like vector slices
through all channels of an activation tensor. Influential neurons are identified by
the strength of their vector norm. Contributing neurons in the previous layer are
the spatials in the receptive field that contribute the most in the direction of the
influential spatial vector that they are combined to produce.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.contrib_adaptive_avg_pool2d">
<span class="sig-name descname"><span class="pre">contrib_adaptive_avg_pool2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.contrib_adaptive_avg_pool2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.contrib_adaptive_avg_pool2d" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a 2D
adaptive average pooling layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing single key in self.model.available_modules() dictionary</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.contrib_conv2d">
<span class="sig-name descname"><span class="pre">contrib_conv2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.contrib_conv2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.contrib_conv2d" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a 2D
convolutional layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing keys in self.model.available_modules() dictionary,
corresponding to a convolutional module and an activation module</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>neuron_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only implemented for convolution using filters with same height and width
and strides equal in both dimensions and padding equal in all dimensions</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.contrib_identity">
<span class="sig-name descname"><span class="pre">contrib_identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.contrib_identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.contrib_identity" title="Permalink to this definition"></a></dt>
<dd><p>Pass through to keep influential neurons from one layer fixed into the
next.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>neuron_counts</em></p></li>
<li><p><em>synapse_counts</em></p></li>
<li><p><em>synapse_weights</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.contrib_linear">
<span class="sig-name descname"><span class="pre">contrib_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.contrib_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.contrib_linear" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a linear/
fully connected layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing single key in self.model.available_modules() dictionary</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.contrib_max2d">
<span class="sig-name descname"><span class="pre">contrib_max2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.contrib_max2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.contrib_max2d" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a 2D
max pooling layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list containing single key in self.model.available_modules() dictionary</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.contrib_resnetadd">
<span class="sig-name descname"><span class="pre">contrib_resnetadd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.contrib_resnetadd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.contrib_resnetadd" title="Permalink to this definition"></a></dt>
<dd><p>Draws synaptic connections between the given influential neurons in a ResNet add
layer and their contributors in a previous layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>infl_neurons</strong> (<em>torch.Tensor</em>) – tensor containing indices of influential neurons in y_out
dimensions: num_influential</p></li>
<li><p><strong>layer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – not used, placeholder for uniformity in arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>neuron_counts</em></p></li>
<li><p><em>synapse_counts</em></p></li>
<li><p><em>synapse_weights</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raises error if len(x_in) != 2 or len(y_out) != 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.create_profile">
<span class="sig-name descname"><span class="pre">create_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.97</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrib_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_infl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deep_data_profiler.classes.profile.Profile</span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.create_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.create_profile" title="Permalink to this definition"></a></dt>
<dd><p>Generate a profile for a single input data x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – input to model being profiled</p></li>
<li><p><strong>layers_to_profile</strong> (<em>list</em><em> or </em><em>tuple</em>) – list of specific layers to profile or tuple with first,last layers
(exclusive of last) to profile and all layers inbetween</p></li>
<li><p><strong>infl_threshold</strong> (<em>float</em><em>, </em><em>default=0.97</em>) – Percentage or quantile used to identify influential neurons</p></li>
<li><p><strong>contrib_threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Percentage of contribution to track in a profile</p></li>
<li><p><strong>use_quantile</strong> (<em>boolean</em><em>, </em><em>default=True</em>) – If True, the infl_threshold argument will be interpreted as a top quantile
to draw influential neurons from,
Otherwise, the infl_threshold argument will be interpreted as the percentage
of the sum of all neuron activations achieved by aggregating the
influential neuron activations</p></li>
<li><p><strong>max_infl</strong> (<em>int</em><em>, </em><em>default=100</em>) – An upper bound on the number of influential neurons to be identified</p></li>
<li><p><strong>norm</strong> (<em>int</em><em>, </em><em>default=2</em>) – The order of the norm to be taken when identifying influential neurons to sum
the strengths of spatial activations, default is L2-norm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>profile contains neuron_counts, neuron_weights, synapse_counts, and synapse_weights
across layers in layers_to_profile. Corresponding number of images = 1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#classes.profile.Profile" title="classes.profile.Profile">Profile</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.influence_generator">
<span class="sig-name descname"><span class="pre">influence_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_infl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.influence_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.influence_generator" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activations</strong> (<em>dict of tensors</em>) – </p></li>
<li><p><strong>use_quantile</strong> (<em>boolean</em><em>, </em><em>default=True</em>) – If True, the function returned by the generator will interpret the threshold
argument as a top quantile to draw influential neurons from,
Otherwise, the threshold argument will be interpreted as the percentage of
the sum of all neuron activations achieved by aggregating the
influential neuron activations</p></li>
<li><p><strong>max_infl</strong> (<em>int</em><em>, </em><em>default=100</em>) – An upper bound on the number of influential neurons to be identified</p></li>
<li><p><strong>norm</strong> (<em>int</em><em>, </em><em>default=2</em>) – The order of the norm to be taken to sum the strengths of spatial activations,
default is L2-norm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>influential_neurons</strong> – A function that will pick out the most influential neurons
in a layer up to some threshold</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.spatial_profiler.SpatialProfiler.single_profile">
<span class="sig-name descname"><span class="pre">single_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">scipy.sparse.coo.coo_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/spatial_profiler.html#SpatialProfiler.single_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.spatial_profiler.SpatialProfiler.single_profile" title="Permalink to this definition"></a></dt>
<dd><p>Profiles a single layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>y_out</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – dict where key is layer, value is tensor
dimensions: batchsize,channels,height,width</p></li>
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix</em>) – Matrix representing the influential neurons in the layer</p></li>
<li><p><strong>ldx</strong> (<em>int</em>) – Layer number of the layer to be profiled</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Percentage of contribution to track in a profile</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>neuron_counts</strong> (<em>sp.coo_matrix or tuple of sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_counts</strong> (<em>sp.coo_matrix</em>)</p></li>
<li><p><strong>synapse_weights</strong> (<em>sp.coo_matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-classes.svd_influential">
<span id="classes-svd-influential-module"></span><h2>classes.svd_influential module<a class="headerlink" href="#module-classes.svd_influential" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classes.svd_influential.</span></span><span class="sig-name descname"><span class="pre">SVDProfiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.container.Sequential</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_svd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">deep_data_profiler.classes.torch_profiler.TorchProfiler</span></code></p>
<p>Torch Profiler wraps a PyTorch model into a TorchHook model which can
register activations as it evaluates data. Using the activations,
inputs to the model may be profiled.</p>
<p>The function call to generate an influenial SVD profile is slightly different
than that for SpatialProfiler/ChannelProfiler. Here is how to create a profile:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">deep_data_profiler</span> <span class="k">as</span> <span class="nn">ddp</span>
<span class="c1"># define the profiler</span>
<span class="n">influential_profiler</span> <span class="o">=</span> <span class="n">ddp</span><span class="o">.</span><span class="n">SVDProfiler</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="c1"># profile a tensor x</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">influential_profiler</span><span class="o">.</span><span class="n">create_influential</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># view neuron weights dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">neuron_weights</span><span class="p">)</span>
<span class="c1"># view the neuron weights for a specific layer</span>
<span class="nb">print</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">neuron_weights</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
<span class="o">...</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.implemented_classes">
<span class="sig-name descname"><span class="pre">implemented_classes</span></span><a class="headerlink" href="#classes.svd_influential.SVDProfiler.implemented_classes" title="Permalink to this definition"></a></dt>
<dd><p>Set of classes in PyTorch which we can find influential for</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#classes.svd_influential.SVDProfiler.model" title="Permalink to this definition"></a></dt>
<dd><p>Model to be profiled</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>torch.nn.Sequential()</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.create_influential">
<span class="sig-name descname"><span class="pre">create_influential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_find</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deep_data_profiler.classes.profile.Profile</span></span></span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler.create_influential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler.create_influential" title="Permalink to this definition"></a></dt>
<dd><p>Generate an influential profile for a single input data x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – input to model being profiled</p></li>
<li><p><strong>layers_to_find</strong> (<em>list</em><em>, </em><em>optional</em>) – Optional list of layers to find influential SVD neurons for.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.1</em>) – Percentage of contribution to track in a profile.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>profile contains neuron_counts, neuron_weights across layers.
Corresponding number of images = 1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#classes.profile.Profile" title="classes.profile.Profile">profile.Profile</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.create_profile">
<span class="sig-name descname"><span class="pre">create_profile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler.create_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler.create_profile" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.create_projections">
<span class="sig-name descname"><span class="pre">create_projections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_find</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler.create_projections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler.create_projections" title="Permalink to this definition"></a></dt>
<dd><p>Generate SVD projections for a single input data x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – input to model being profiled</p></li>
<li><p><strong>layers_to_find</strong> (<em>list</em><em>, </em><em>optional</em>) – Optional list of layers to find influential SVD neurons for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>projections</strong> – SVD projections keyed by layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.create_svd">
<span class="sig-name descname"><span class="pre">create_svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers_to_find</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None._VariableFunctionsClass.svd</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler.create_svd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler.create_svd" title="Permalink to this definition"></a></dt>
<dd><p>Create a dictionary of the Singular Value Decomposition
of a layer’s weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>layers_to_find</strong> (<em>list</em><em>, </em><em>optional</em>) – Optional list of layers to find influential SVD neurons for.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>svd_dict</strong> – A dictionary of SVD of weights, keyed by their position from
the beginning of the model, according to the order the layers
of the model are listed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.influence_generator">
<span class="sig-name descname"><span class="pre">influence_generator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler.influence_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler.influence_generator" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.influential_svd_neurons">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">influential_svd_neurons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler.influential_svd_neurons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler.influential_svd_neurons" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of relative contributions keyed by influential
SVD neurons for layer up to some threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agg</strong> (<em>torch.Tensor</em>) – The SVD projections tensor, with some aggregation
applied. Expected to be 1-D.</p></li>
<li><p><strong>(</strong><strong>int</strong> (<em>ord</em>) – order of norm. See
<a class="reference external" href="https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm">https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm</a></p></li>
<li><p><strong>float</strong> – order of norm. See
<a class="reference external" href="https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm">https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm</a></p></li>
<li><p><strong>+/-inf</strong> – order of norm. See
<a class="reference external" href="https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm">https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm</a></p></li>
<li><p><strong>'fro'</strong> – order of norm. See
<a class="reference external" href="https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm">https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm</a></p></li>
<li><p><strong>'nuc'</strong> – order of norm. See
<a class="reference external" href="https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm">https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm</a></p></li>
<li><p><strong>optional</strong><strong>)</strong> – order of norm. See
<a class="reference external" href="https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm">https://pytorch.org/docs/stable/linalg.html#torch.linalg.norm</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>influential_neurons</strong> (<em>sp.coo_matrix</em>) – Matrix representing the influential neurons within the threshold</p></li>
<li><p><strong>influential_weights</strong> (<em>sp.coo_matrix</em>) – Matrix assigning weights to each influential neuron according to its
contribution to the threshold</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.svd_influential.SVDProfiler.single_profile">
<span class="sig-name descname"><span class="pre">single_profile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/svd_influential.html#SVDProfiler.single_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.svd_influential.SVDProfiler.single_profile" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-classes.torch_profiler">
<span id="classes-torch-profiler-module"></span><h2>classes.torch_profiler module<a class="headerlink" href="#module-classes.torch_profiler" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classes.torch_profiler.</span></span><span class="sig-name descname"><span class="pre">TorchProfiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>A TorchProfiler wraps a PyTorch model into a TorchHook model which can register
activations as it evaluates data. Subclasses of TorchProfiler profile model inputs
by tracing influential neurons through the layers of the network during classification.
Each subclass implementation defines neurons, influence, and contribution differently.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.activation_classes">
<span class="sig-name descname"><span class="pre">activation_classes</span></span><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.activation_classes" title="Permalink to this definition"></a></dt>
<dd><p>List of activation classes in PyTorch</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.dropout_classes">
<span class="sig-name descname"><span class="pre">dropout_classes</span></span><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.dropout_classes" title="Permalink to this definition"></a></dt>
<dd><p>List of dropout classes in PyTorch</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.implemented_classes">
<span class="sig-name descname"><span class="pre">implemented_classes</span></span><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.implemented_classes" title="Permalink to this definition"></a></dt>
<dd><p>List of classes in PyTorch which have contrib functions implemented</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.contrib_functions">
<span class="sig-name descname"><span class="pre">contrib_functions</span></span><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.contrib_functions" title="Permalink to this definition"></a></dt>
<dd><p>List of contrib functions ordered by their corresponding classes in
implemented_classes (does not include “contrib_resnetadd”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.model" title="Permalink to this definition"></a></dt>
<dd><p>Model to be profiled</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.build_dicts">
<span class="sig-name descname"><span class="pre">build_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infl_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrib_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler.build_dicts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.build_dicts" title="Permalink to this definition"></a></dt>
<dd><p>Generates neuron/synapse counts/weights for a given input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – input to model being profiled</p></li>
<li><p><strong>layers_to_profile</strong> (<em>list</em><em> or </em><em>tuple</em>) – list of specific layers to profile or tuple with first,last layers
(exclusive of last) to profile and all layers in between</p></li>
<li><p><strong>infl_threshold</strong> (<em>float</em>) – Parameter for influence</p></li>
<li><p><strong>contrib_threshold</strong> (<em>float</em>) – Parameter for contribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>neuron_counts</em></p></li>
<li><p><em>neuron_weights</em></p></li>
<li><p><em>synapse_counts</em></p></li>
<li><p><em>synapse_weights</em></p></li>
<li><p><em>activation_shapes</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.create_layers">
<span class="sig-name descname"><span class="pre">create_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler.create_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.create_layers" title="Permalink to this definition"></a></dt>
<dd><p>Create a dictionary of layers to profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>layerdict</strong> – A dictionary of layers keyed by their position according to the order Pytorch
uses to list the layers of the model.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>OrderedDict</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because a weighted module is often followed by an activation and/or normalization
modules those modules are combined into a single layer to be profiled. As a
consequence the number of layers generated will typically be less than the number
of available modules in the model.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.create_profile">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_profile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler.create_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.create_profile" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.influence_generator">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">influence_generator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler.influence_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.influence_generator" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.sgheadtail">
<span class="sig-name descname"><span class="pre">sgheadtail</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler.sgheadtail"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.sgheadtail" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>sght</strong> – Dictionary of the names of the head and tail modules at each layer</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.single_profile">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_profile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler.single_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.single_profile" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="classes.torch_profiler.TorchProfiler.super_nodes_graph">
<span class="sig-name descname"><span class="pre">super_nodes_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">collections.OrderedDict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">networkx.classes.digraph.DiGraph</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/classes/torch_profiler.html#TorchProfiler.super_nodes_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#classes.torch_profiler.TorchProfiler.super_nodes_graph" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>supernodes</strong> (<em>OrderedDict</em>)</p></li>
<li><p><strong>SG</strong> (<em>nx.DiGraph</em>)</p></li>
<li><p><strong>sgpos</strong> (<em>dict</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-classes">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-classes" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="classes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../algorithms/modules.html" class="btn btn-neutral float-right" title="algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020 Battelle Memorial Institute.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
